Проект состоит из двух частей: 1) Серверная часть 2) Андроид приложение

npm install
npm run init-db

запуск: 
Для разработки
npm run dev

Для тестирования
npm start

без HTTPS
npm run http

Для глобального запуска:
npm install -g ngrok
ngrok authtoken ваш_токен_здесь
ngrok http 3000

number-sum-server/
├── config/             # Конфигурация подключения к базе данных
├── controllers/        # Контроллеры для обработки запросов
│   ├── auth.controller.js    # Аутентификация и пользователи
│   ├── license.controller.js # Управление лицензиями
│   └── payment.controller.js # Обработка платежей
├── db/                 # Директория с базой данных SQLite
├── middleware/         # Middleware для Express
│   ├── auth.middleware.js    # Авторизация
│   └── error.middleware.js   # Обработка ошибок
├── models/             # Модели данных
│   ├── license.model.js      # Модель лицензии
│   ├── payment.model.js      # Модель платежа
│   └── user.model.js         # Модель пользователя
├── public/             # Статические файлы
│   ├── css/                  # Стили
│   ├── js/                   # JavaScript
│   ├── downloads/            # APK-файлы для скачивания
│   ├── demo-sbp/             # Демо-страницы оплаты через СБП
│   ├── auth/                 # Страницы аутентификации
│   └── *.html                # HTML-страницы сайта
├── routes/             # Маршруты API
│   ├── auth.routes.js        # Маршруты аутентификации
│   ├── license.routes.js     # Маршруты лицензий
│   └── payment.routes.js     # Маршруты платежей
├── utils/              # Утилиты
│   ├── email.util.js         # Отправка электронной почты
│   └── sbp.util.js           # Работа с СБП (Система быстрых платежей)
├── .env                # Переменные окружения
├── package.json        # Зависимости и скрипты
├── server.js           # Основной файл сервера
└── http-server.js      # HTTP-версия сервера

О проекте
"Number Sum" представляет собой полнофункциональную веб-платформу для распространения и продажи Android-приложения калькулятора. 
Проект объединяет несколько ключевых систем: пользовательскую авторизацию, обработку платежей, лицензирование и распространение APK-файла.
Архитектура и компоненты
1. Backend (Node.js + Express)
Backend построен на Express.js с использованием архитектуры MVC (Model-View-Controller):

Модели (models) – представляют структуры данных и бизнес-логику:

user.model.js – управление пользователями (регистрация, авторизация)
payment.model.js – обработка платежей
license.model.js – управление лицензиями


Контроллеры (controllers) – обрабатывают запросы и формируют ответы:

auth.controller.js – процессы авторизации
payment.controller.js – создание и проверка платежей
license.controller.js – проверка и управление лицензиями


Middleware – промежуточные обработчики запросов:

auth.middleware.js – проверка токенов JWT для защиты маршрутов
error.middleware.js – централизованная обработка ошибок



2. База данных
Проект использует SQLite – встроенную файловую базу данных:

Инициализация через init-db.js
Три основные таблицы:

пользователи – хранение учетных записей
платежи – информация о транзакциях
лицензии – привязка лицензий к пользователям



3. Frontend
Frontend реализован с использованием стандартных веб-технологий:

HTML страницы (index.html, login.html, и др.)
CSS стили (main.css)
JavaScript (main.js)
Страницы для демонстрации платежей через СБП

Как работает система
1. Процесс регистрации и авторизации

Пользователь регистрируется через /auth/register.html
Backend создает запись в базе данных (таблица пользователи)
Сервер генерирует JWT-токен и отправляет его пользователю
Системы отправки email отправляет письмо с подтверждением (опционально)
Токен сохраняется в localStorage браузера для последующей авторизации

2. Процесс оплаты

Авторизованный пользователь нажимает кнопку "Купить"
Система создает запись в таблице платежи со статусом "pending"
Пользователь перенаправляется на страницу оплаты через СБП (pay.html)
На странице оплаты отображается QR-код и таймер (5 минут)
Пользователь может перейти на страницу payment-link.html для имитации оплаты
После оплаты система обновляет статус платежа на "completed"
Активируется лицензия – создается запись в таблице лицензии

3. Проверка лицензии

Приложение при запуске проверяет наличие лицензии у пользователя
Запрос к /api/license/check с JWT-токеном для идентификации
Система проверяет наличие записи в таблице лицензии для данного пользователя
В зависимости от результата, функциональность приложения ограничивается или предоставляется полностью

4. Распространение приложения

На странице /download.html пользователи могут скачать APK-файл
Файл хранится в директории /public/downloads/
Сервер предоставляет файл через маршрут /downloads/number-sum.apk
Использованы оптимизации для эффективной доставки большого файла (9.38 MB)

Технические особенности

Безопасность:

Пароли хешируются с использованием bcrypt
Маршруты API защищены через JWT-авторизацию
Реализована защита от XSS и других атак


Масштабируемость:

Модульная структура кода
Разделение бизнес-логики и представления
Поддержка работы через VPN/Ngrok для внешнего доступа


Взаимодействие компонентов:

Frontend взаимодействует с Backend через RESTful API
Авторизация через Bearer токены
Асинхронные запросы через fetch API в JavaScript


Основные функции сайта для распространения приложения:
Главная страница с описанием функций
Страница загрузки APK-файла
Страница оплаты


Система пользователей:
Регистрация и вход
Подтверждение email
Восстановление пароля


Система платежей:
Оплата через СБП (имитация)
QR-код для оплаты
Проверка статуса платежа


Система лицензирования:
Проверка лицензии пользователя
Активация лицензии после оплаты
